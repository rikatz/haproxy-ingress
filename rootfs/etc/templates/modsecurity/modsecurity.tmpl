  # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
# #
# #   HAProxy Ingress Controller
# #   --------------------------
# #   This file is automatically updated, do not edit
# #
#
{{- $modsec := .Global.ModSecurity }}
[modsecurity]
spoe-agent modsecurity-agent
    messages     modsecurity
    option       var-prefix  modsec
    timeout      hello       {{ $modsec.Timeout.Hello }}
    timeout      idle        {{ $modsec.Timeout.Idle }}
    timeout      processing  {{ $modsec.Timeout.Processing }}
    use-backend  spoe-modsecurity
spoe-message modsecurity
    args method=method path=path query=query reqver=req.ver clientip=src reqhdrs=req.hdrs_bin reqbody=req.body ignorerules=var(txn.ignorerules) srvip=dst srvport=dst_port namespace=var(txn.namespace) ingressname=var(txn.ingressname)
    event  on-backend-http-request
